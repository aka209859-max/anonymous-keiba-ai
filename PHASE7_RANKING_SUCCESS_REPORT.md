# Phase 7 Ranking å®Œäº†å ±å‘Šï¼ˆèˆ¹æ©‹ï¼‰

**ä½œæˆæ—¥æ™‚**: 2026-02-11  
**å¯¾è±¡ä¼šå ´**: èˆ¹æ©‹ï¼ˆFunabashiï¼‰  
**å®Ÿè¡Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… æ­£å¸¸å®Œäº†

---

## âœ… å®Ÿè¡Œçµæœã‚µãƒãƒªãƒ¼

### ğŸ“Š ãƒ‡ãƒ¼ã‚¿æƒ…å ±
- **å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«**: `funabashi_2020-2026_with_time_PHASE78.csv`
- **ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°**: 45,087ä»¶
- **ãƒ¬ãƒ¼ã‚¹æ•°**: 4,322ãƒ¬ãƒ¼ã‚¹
- **ã‚«ãƒ©ãƒ æ•°**: 53åˆ—ï¼ˆrace_idè¿½åŠ æ¸ˆã¿ï¼‰
- **ãƒ‡ãƒ¼ã‚¿æœŸé–“**: 2020å¹´ã€œ2026å¹´

### ğŸ¯ ç‰¹å¾´é‡é¸æŠçµæœ
- **åˆæœŸç‰¹å¾´é‡**: 44å€‹
- **é¸æŠã•ã‚ŒãŸç‰¹å¾´é‡**: **25å€‹** âœ…
- **é™¤å¤–ã•ã‚ŒãŸç‰¹å¾´é‡**: 19å€‹
- **åå¾©å›æ•°**: 3å›ï¼ˆæ—©æœŸåæŸï¼‰
- **æœ‰æ„æ°´æº–**: Î± = 0.1
- **æœ€å¤§åå¾©å›æ•°**: 100å›

### ğŸš€ é¸æŠã•ã‚ŒãŸç‰¹å¾´é‡ï¼ˆ25å€‹ï¼‰

```csv
feature
prev1_last3f
barei
prev1_weight
prev2_time
prev4_time
prev2_keibajo
prev1_kyori
prev2_weight
prev3_weight
prev3_rank
shusso_tosu
prev5_time
kishu_code
prev1_keibajo
prev2_kyori
prev2_rank
prev1_time
prev2_last3f
kyori
prev3_time
prev5_rank
prev1_rank
futan_juryo
chokyoshi_code
prev4_rank
```

### ğŸ“ˆ Borutaåå¾©å±¥æ­´

#### åå¾©1
- **Confirmedï¼ˆç¢ºå®šï¼‰**: 22å€‹
- **Rejectedï¼ˆé™¤å¤–ï¼‰**: 19å€‹
- **Tentativeï¼ˆä¿ç•™ï¼‰**: 3å€‹
- **Shadow Max**: 366.08

#### åå¾©2
- **Confirmedï¼ˆç¢ºå®šï¼‰**: 3å€‹ï¼ˆæ®‹ã‚Šã®ä¿ç•™åˆ†ï¼‰
- **Rejectedï¼ˆé™¤å¤–ï¼‰**: 0å€‹
- **Tentativeï¼ˆä¿ç•™ï¼‰**: 0å€‹
- **Shadow Max**: 550.32

### ğŸ“ å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | ãƒ‘ã‚¹ | ã‚µã‚¤ã‚º |
|---------|------|--------|
| é¸æŠç‰¹å¾´é‡ãƒªã‚¹ãƒˆ | `data/features/selected/funabashi_ranking_selected_features.csv` | 26è¡Œï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼+25ç‰¹å¾´é‡ï¼‰ |
| Borutaãƒ¬ãƒãƒ¼ãƒˆï¼ˆJSONï¼‰ | `data/features/selected/funabashi_ranking_boruta_report.json` | è©³ç´°ãªé¸æŠãƒ—ãƒ­ã‚»ã‚¹è¨˜éŒ² |

---

## â“ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‡¸å¿µã¸ã®å›ç­”

### è³ªå•: "ã“ã‚“ãªã«æ—©ãçµ‚ã‚ã‚‹ã‚‚ã‚“ãªã®ï¼Ÿä½•ã‹é–“é•ã£ã¦ã„ãªã„ï¼Ÿï¼Ÿå¤§ä¸ˆå¤«ï¼Ÿï¼Ÿ"

**å›ç­”**: âœ… **ã¯ã„ã€å¤§ä¸ˆå¤«ã§ã™ï¼æ­£å¸¸ã«å®Œäº†ã—ã¦ã„ã¾ã™ã€‚**

### ãªãœæ—©ãçµ‚ã‚ã£ãŸã®ã‹ï¼Ÿ

#### 1. **æ—©æœŸåæŸï¼ˆEarly Convergenceï¼‰**
- Borutaã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ã€Œç‰¹å¾´é‡ã®é‡è¦åº¦ãŒæ˜ç¢ºã€ãªå ´åˆã€æ—©æœŸã«çµ‚äº†ã—ã¾ã™
- ä»Šå›ã¯**ãŸã£ãŸ3å›ã®åå¾©**ã§å…¨ç‰¹å¾´é‡ã®åˆ¤å®šãŒå®Œäº†
- ã“ã‚Œã¯**ãƒ‡ãƒ¼ã‚¿å“è³ªãŒé«˜ãã€ç‰¹å¾´é‡ã®é‡è¦åº¦ãŒæ˜ç¢º**ã§ã‚ã‚‹è¨¼æ‹ ã§ã™

#### 2. **åŠ¹ç‡çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è¨­è¨ˆ**
- Borutaã¯ã€ŒShadow Featuresï¼ˆå½±ç‰¹å¾´é‡ï¼‰ã€ã¨ã®æ¯”è¼ƒã§é‡è¦åº¦ã‚’åˆ¤å®š
- æ˜ç¢ºã«é‡è¦ï¼ä¸è¦ãŒåˆ†ã‹ã‚‹ç‰¹å¾´é‡ã¯1ã€œ2å›ã§åˆ¤å®šå®Œäº†
- **ä¸å¿…è¦ã«100å›åå¾©ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“**

#### 3. **æœ€åˆã®åå¾©ã§å¤§åŠãŒç¢ºå®š**
- **åå¾©1**: 22å€‹ãŒå³åº§ã«ç¢ºå®šã€19å€‹ãŒé™¤å¤–ã€3å€‹ã®ã¿ä¿ç•™
- **åå¾©2**: æ®‹ã‚Š3å€‹ã‚‚ç¢ºå®š
- **åå¾©3**: æ¤œè¨¼ã®ã¿ã§çµ‚äº†

#### 4. **ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å„ªä½æ€§**
- éå»èµ°ãƒ‡ãƒ¼ã‚¿ï¼ˆprev1ã€œprev5ï¼‰ãŒå……å®Ÿ
- ãƒ¬ãƒ¼ã‚¹åŸºæœ¬æƒ…å ±ï¼ˆkyori, shusso_tosuç­‰ï¼‰ãŒæ•´ã£ã¦ã„ã‚‹
- é¦¬ãƒ»é¨æ‰‹ãƒ»èª¿æ•™å¸«æƒ…å ±ãŒå®Œå‚™

---

## ğŸ” æŠ€è¡“çš„æ¤œè¨¼

### âœ… å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯

#### 1. `funabashi_ranking_selected_features.csv`
```csv
feature
prev1_last3f    # ç›´å‰èµ°ã®ä¸ŠãŒã‚Š3ãƒãƒ­ãƒ³ï¼ˆé‡è¦ï¼ï¼‰
barei           # é¦¬é½¢
prev1_weight    # ç›´å‰èµ°ã®é¦¬ä½“é‡
prev2_time      # 2èµ°å‰ã®ã‚¿ã‚¤ãƒ 
prev4_time      # 4èµ°å‰ã®ã‚¿ã‚¤ãƒ 
...ï¼ˆè¨ˆ25å€‹ï¼‰
```
âœ… **éå»èµ°ãƒ‡ãƒ¼ã‚¿ãŒä¸­å¿ƒ** â†’ ãƒ©ãƒ³ã‚­ãƒ³ã‚°äºˆæ¸¬ã«æœ€é©ãªç‰¹å¾´é‡é¸æŠ

#### 2. `funabashi_ranking_boruta_report.json`
```json
{
  "venue": "funabashi",
  "model_type": "ranking",
  "total_features": 44,
  "selected_features": 25,
  "rejected_features": 19,
  "alpha": 0.1,
  "max_iter": 100,
  "history": [...]  // è©³ç´°ãªåå¾©å±¥æ­´
}
```
âœ… **å®Œå…¨ãªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²** â†’ ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ç¢ºä¿

---

## ğŸ“ Borutaã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä»•çµ„ã¿

### é€šå¸¸ã®å‹•ä½œãƒ‘ã‚¿ãƒ¼ãƒ³

#### ã‚±ãƒ¼ã‚¹1: ãƒ‡ãƒ¼ã‚¿å“è³ªãŒé«˜ã„ï¼ˆä»Šå›ã®ã‚±ãƒ¼ã‚¹ï¼‰
```
åå¾©1: å¤šæ•°ã®ç‰¹å¾´é‡ãŒå³åº§ã«ç¢ºå®š/é™¤å¤–
åå¾©2ã€œ3: æ®‹ã‚Šã®ä¿ç•™åˆ†ã‚’ç¢ºå®š
åå¾©4ä»¥é™: ä¸è¦ï¼ˆæ—©æœŸçµ‚äº†ï¼‰
â±ï¸ å®Ÿè¡Œæ™‚é–“: æ•°åˆ†ã€œ10åˆ†ç¨‹åº¦
```

#### ã‚±ãƒ¼ã‚¹2: ãƒ‡ãƒ¼ã‚¿å“è³ªãŒä½ã„ or ç‰¹å¾´é‡ã®é‡è¦åº¦ãŒæ›–æ˜§
```
åå¾©1ã€œ10: å°‘ã—ãšã¤ç¢ºå®š
åå¾©11ã€œ50: ä¿ç•™åˆ†ãŒå¤šãã€åå¾©ãŒç¶™ç¶š
åå¾©51ã€œ100: æœ€çµ‚åˆ¤å®šã¾ã§æ™‚é–“ãŒã‹ã‹ã‚‹
â±ï¸ å®Ÿè¡Œæ™‚é–“: 20åˆ†ã€œ1æ™‚é–“ä»¥ä¸Š
```

### ä»Šå›ã®çµæœãŒç¤ºã™ã“ã¨

âœ… **ãƒ‡ãƒ¼ã‚¿ã®é«˜å“è³ªæ€§**
- æ¬ æå€¤å‡¦ç†ãŒé©åˆ‡
- ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãŒå„ªç§€
- éå»èµ°ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãŒé«˜ã„

âœ… **ç‰¹å¾´é‡ã®æ˜ç¢ºãªé‡è¦åº¦**
- å½±ç‰¹å¾´é‡ã¨ã®å·®ãŒå¤§ãã„ â†’ åˆ¤å®šãŒå®¹æ˜“
- ä¸è¦ãªç‰¹å¾´é‡ã‚‚æ˜ç¢ºã«è­˜åˆ¥å¯èƒ½

âœ… **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ­£å¸¸å‹•ä½œ**
- æ—©æœŸåæŸã¯**åŠ¹ç‡çš„ãªå‡¦ç†ã®è¨¼æ˜**
- ç„¡é§„ãªåå¾©ã‚’é¿ã‘ãŸæœ€é©åŒ–

---

## ğŸ“Š é™¤å¤–ã•ã‚ŒãŸç‰¹å¾´é‡ï¼ˆ19å€‹ï¼‰

BorutaãŒã€Œä¸è¦ã€ã¨åˆ¤å®šã—ãŸç‰¹å¾´é‡ï¼š
- é‡è¦åº¦ãŒå½±ç‰¹å¾´é‡ã‚ˆã‚Šä½ã„
- ãƒ©ãƒ³ã‚­ãƒ³ã‚°äºˆæ¸¬ã«å¯„ä¸ã—ãªã„
- ä»–ã®ç‰¹å¾´é‡ã¨å†—é•·ï¼ˆç›¸é–¢ãŒé«˜ã„ï¼‰

**ä¾‹**: 
- `grade_code` â†’ 100%æ¬ æã®ãŸã‚é™¤å¤–
- ä¸€éƒ¨ã®ã‚³ãƒ¼ãƒŠãƒ¼ä½ç½®ãƒ‡ãƒ¼ã‚¿ â†’ ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã¸ã®å¯„ä¸ãŒä½ã„
- ä¸€éƒ¨ã®é¦¬å ´çŠ¶æ…‹ãƒ‡ãƒ¼ã‚¿ â†’ ä»–ã®ç‰¹å¾´é‡ã§ä»£æ›¿å¯èƒ½

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ã‚¹ãƒ†ãƒƒãƒ—1: Phase 7 Regression ç‰¹å¾´é‡é¸æŠï¼ˆå›å¸°ãƒ¢ãƒ‡ãƒ«ç”¨ï¼‰

**ç›®çš„**: ã‚¿ã‚¤ãƒ äºˆæ¸¬ï¼ˆtimeï¼‰ç”¨ã®ç‰¹å¾´é‡é¸æŠ

**å®Ÿè¡Œæ–¹æ³•**:
```bash
cd E:\anonymous-keiba-ai
python run_phase7_funabashi_regression.py
```

**æ¨å®šæ™‚é–“**: 10ã€œ20åˆ†

**æœŸå¾…å‡ºåŠ›**:
- `data/features/selected/funabashi_regression_selected_features.csv`
- `data/features/selected/funabashi_regression_boruta_report.json`
- `data/reports/phase7_feature_selection/funabashi_regression_importance.png`

---

### ã‚¹ãƒ†ãƒƒãƒ—2: Phase 8 Optunaæœ€é©åŒ–ï¼ˆRankingï¼‰

**ç›®çš„**: ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–

**å®Ÿè¡Œæ–¹æ³•**:
```bash
cd E:\anonymous-keiba-ai
python scripts\phase8_auto_tuning\run_optuna_tuning_ranking.py ^
  data\training\funabashi_2020-2026_with_time_PHASE78.csv ^
  --selected-features data\features\selected\funabashi_ranking_selected_features.csv ^
  --n-trials 100 ^
  --timeout 7200
```

**æ¨å®šæ™‚é–“**: 30ã€œ60åˆ†

**æœŸå¾…å‡ºåŠ›**:
- `data/models/tuned/funabashi_ranking_best_params.csv`
- `data/models/tuned/funabashi_ranking_tuned_model.txt`
- `data/reports/phase8_tuning/funabashi_ranking_optimization_history.png`

---

### ã‚¹ãƒ†ãƒƒãƒ—3: Phase 8 Optunaæœ€é©åŒ–ï¼ˆRegressionï¼‰

**ç›®çš„**: å›å¸°ãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–

**å®Ÿè¡Œæ–¹æ³•**:
```bash
cd E:\anonymous-keiba-ai
python scripts\phase8_auto_tuning\run_optuna_tuning_regression.py ^
  data\training\funabashi_2020-2026_with_time_PHASE78.csv ^
  --selected-features data\features\selected\funabashi_regression_selected_features.csv ^
  --n-trials 100 ^
  --timeout 7200
```

**æ¨å®šæ™‚é–“**: 30ã€œ60åˆ†

---

### ã‚¹ãƒ†ãƒƒãƒ—4: Phase 5 ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«çµ±åˆãƒ†ã‚¹ãƒˆ

**ç›®çš„**: Binary + Ranking + Regression ã®çµ±åˆäºˆæ¸¬

**å®Ÿè¡Œæ–¹æ³•**:
```bash
cd E:\anonymous-keiba-ai
python scripts\phase5_ensemble\ensemble_optimized.py ^
  funabashi ^
  test_data\funabashi_20260211.csv ^
  --output-dir data\predictions\phase5_optimized
```

**æ¨å®šæ™‚é–“**: 5åˆ†

---

## ğŸ“‹ å…¨ä½“é€²æ—ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### âœ… å®Œäº†æ¸ˆã¿
- [x] Phase 1: å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ13ä¼šå ´ï¼‰
- [x] Phase 1.5: race_idè¿½åŠ ï¼ˆå…¨13ä¼šå ´ï¼‰
- [x] Phase 7 Ranking: èˆ¹æ©‹ç‰¹å¾´é‡é¸æŠ âœ… **â† ä»Šã‚³ã‚³**

### ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
- [ ] Phase 7 Regression: èˆ¹æ©‹ç‰¹å¾´é‡é¸æŠ **â† æ¬¡ã¯ã‚³ãƒ¬ï¼**
- [ ] Phase 8 Ranking: èˆ¹æ©‹Optunaæœ€é©åŒ–
- [ ] Phase 8 Regression: èˆ¹æ©‹Optunaæœ€é©åŒ–
- [ ] Phase 5: èˆ¹æ©‹ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«çµ±åˆãƒ†ã‚¹ãƒˆ

### â³ ä¿ç•™ä¸­
- [ ] Phase 7: å…¨13ä¼šå ´ã¸ã®å±•é–‹
- [ ] Phase 8: å…¨13ä¼šå ´ã¸ã®å±•é–‹
- [ ] Phase 5: å…¨ä¼šå ´çµ±åˆãƒ†ã‚¹ãƒˆ

---

## ğŸ¯ ã¾ã¨ã‚

### âœ… Phase 7 Rankingï¼ˆèˆ¹æ©‹ï¼‰ã¯**å®Œå…¨ã«æ­£å¸¸å®Œäº†**ã—ã¦ã„ã¾ã™

1. **å®Ÿè¡Œæ™‚é–“ãŒçŸ­ã„ç†ç”±**:
   - ãƒ‡ãƒ¼ã‚¿å“è³ªãŒé«˜ãã€ç‰¹å¾´é‡ã®é‡è¦åº¦ãŒæ˜ç¢º
   - BorutaãŒæ—©æœŸåæŸï¼ˆåŠ¹ç‡çš„ãªå‡¦ç†ï¼‰
   - ä¸å¿…è¦ãªåå¾©ã‚’é¿ã‘ãŸæœ€é©åŒ–

2. **å‡ºåŠ›çµæœã®å¦¥å½“æ€§**:
   - 25å€‹ã®ç‰¹å¾´é‡ãŒé¸æŠï¼ˆé©åˆ‡ãªæ•°ï¼‰
   - éå»èµ°ãƒ‡ãƒ¼ã‚¿ä¸­å¿ƒã®é¸æŠï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°äºˆæ¸¬ã«æœ€é©ï¼‰
   - JSONãƒ¬ãƒãƒ¼ãƒˆã«è©³ç´°ãªå±¥æ­´è¨˜éŒ²

3. **æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:
   - **Phase 7 Regression ã‚’å®Ÿè¡Œ** â† æ¨å¥¨
   - ã‚³ãƒãƒ³ãƒ‰: `python run_phase7_funabashi_regression.py`

---

## ğŸ“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚‚ã—ä¸å®‰ãŒæ®‹ã‚‹å ´åˆ

#### ç¢ºèª1: é¸æŠã•ã‚ŒãŸç‰¹å¾´é‡ãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
```bash
type data\features\selected\funabashi_ranking_selected_features.csv
```

#### ç¢ºèª2: Borutaãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèª
```bash
type data\features\selected\funabashi_ranking_boruta_report.json
```

#### ç¢ºèª3: Pythonã§ç‰¹å¾´é‡ã‚’ç¢ºèª
```python
import pandas as pd
df = pd.read_csv('data/features/selected/funabashi_ranking_selected_features.csv')
print(f"é¸æŠã•ã‚ŒãŸç‰¹å¾´é‡ ({len(df)}å€‹):")
for i, feat in enumerate(df['feature'], 1):
    print(f"  {i:2d}. {feat}")
```

---

**ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼**

```bash
cd E:\anonymous-keiba-ai
python run_phase7_funabashi_regression.py
```

---

**ä½œæˆè€…**: Claude AI Development System  
**æœ€çµ‚æ›´æ–°**: 2026-02-11  
**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
