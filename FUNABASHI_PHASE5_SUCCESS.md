# ğŸ‰ èˆ¹æ©‹ Phase 5 Ensemble ãƒ†ã‚¹ãƒˆæˆåŠŸãƒ¬ãƒãƒ¼ãƒˆ

**å®Ÿè¡Œæ—¥**: 2026-02-11  
**å¯¾è±¡**: èˆ¹æ©‹ï¼ˆFunabashiï¼‰Phase 5 æœ€é©åŒ–ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«çµ±åˆ  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… **å®Œå…¨æˆåŠŸ**

---

## âœ… **å®Ÿè¡Œçµæœã‚µãƒãƒªãƒ¼**

### **ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿**
- ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: **100ä»¶**
- ãƒ¬ãƒ¼ã‚¹æ•°: **10ãƒ¬ãƒ¼ã‚¹**
- æœŸé–“: 2020å¹´1æœˆ7æ—¥ï¼ˆkaisai_tsukihi: 107ï¼‰

### **äºˆæ¸¬çµæœ**
- å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«: `funabashi_107_ensemble_optimized.csv` (13.2KB)
- ã‚µãƒãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«: `funabashi_107_ensemble_optimized_summary.json`

---

## ğŸ“Š **Ensemble Score çµ±è¨ˆ**

| æŒ‡æ¨™ | å€¤ |
|------|------|
| å¹³å‡ | 0.459 |
| æ¨™æº–åå·® | 0.119 |
| æœ€å°å€¤ | 0.114 |
| æœ€å¤§å€¤ | 0.764 |

### **ãƒ¢ãƒ‡ãƒ«åˆ¥ã‚¹ã‚³ã‚¢çµ±è¨ˆ**

#### **Binaryï¼ˆè¤‡å‹åœå†…ç¢ºç‡ï¼‰**
- å¹³å‡: 0.376
- æ¨™æº–åå·®: 0.274

#### **Rankingï¼ˆç›¸å¯¾çš„å¼·ã•ï¼‰**
- å¹³å‡: -0.882
- æ¨™æº–åå·®: 1.218

#### **Regressionï¼ˆèµ°ç ´ã‚¿ã‚¤ãƒ äºˆæ¸¬ï¼‰**
- å¹³å‡: 1321.4ç§’ (ç´„22åˆ†)
- æ¨™æº–åå·®: 137.7ç§’

---

## ğŸ† **äºˆæ¸¬çµæœã‚µãƒ³ãƒ—ãƒ«ï¼ˆãƒ¬ãƒ¼ã‚¹ 2020_0107_43_03ï¼‰**

| é¦¬ç•ª | Ensemble Score | äºˆæ¸¬ç€é † | Binaryç¢ºç‡ | Rankingé †ä½ | äºˆæ¸¬ã‚¿ã‚¤ãƒ  |
|------|----------------|----------|------------|-------------|------------|
| 8 | **0.557** | **1ä½** | 0.272 (2ä½) | -0.117 (2ä½) | 1380.5ç§’ (2ä½) |
| 10 | 0.500 | 2ä½ | 0.018 (5ä½) | **0.675 (1ä½)** | 1399.0ç§’ (5ä½) |
| 12 | 0.500 | 2ä½ | **0.798 (1ä½)** | -1.974 (5ä½) | **1365.2ç§’ (1ä½)** |
| 9 | 0.471 | 4ä½ | 0.242 (3ä½) | -0.453 (4ä½) | 1382.5ç§’ (3ä½) |
| 11 | 0.448 | 5ä½ | 0.206 (4ä½) | -0.209 (3ä½) | 1391.8ç§’ (4ä½) |

### **åˆ†æ**
- **é¦¬ç•ª8**: Ensemble Score æœ€é«˜ï¼ˆ0.557ï¼‰ã§1ä½äºˆæ¸¬
  - Binary: 2ä½ã€Ranking: 2ä½ã€Time: 2ä½ â†’ ãƒãƒ©ãƒ³ã‚¹è‰¯ãä¸Šä½
- **é¦¬ç•ª10**: Ranking Score ãŒæœ€é«˜ï¼ˆ0.675ï¼‰ã§ç·åˆ2ä½
  - Ranking ãƒ¢ãƒ‡ãƒ«ãŒå¼·ãæ¨ã—ãŸé¦¬
- **é¦¬ç•ª12**: Binaryç¢ºç‡ãŒæœ€é«˜ï¼ˆ0.798ï¼‰ã€äºˆæ¸¬ã‚¿ã‚¤ãƒ ã‚‚æœ€é€Ÿ
  - è¤‡å‹åœå†…ç¢ºç‡ãŒé«˜ãã€ã‚¿ã‚¤ãƒ ã‚‚é€Ÿã„äºˆæ¸¬

---

## ğŸ¯ **ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«çµ±åˆã®åŠ¹æœ**

### **çµ±åˆæˆ¦ç•¥**
```
Ensemble Score = Binary Ã— 0.3 + Ranking Ã— 0.5 + Regression Ã— 0.2
```

### **å„ãƒ¢ãƒ‡ãƒ«ã®å½¹å‰²**

#### **1. Binaryï¼ˆ30%ï¼‰: è¤‡å‹åœå†…ç¢ºç‡**
- 3ç€ä»¥å†…ã«å…¥ã‚‹ç¢ºç‡ã‚’äºˆæ¸¬
- é«˜ç¢ºç‡ã®é¦¬ã‚’å„ªå…ˆ

#### **2. Rankingï¼ˆ50%ï¼‰: ç›¸å¯¾çš„å¼·ã•**
- ãƒ¬ãƒ¼ã‚¹å†…ã§ã®ç›¸å¯¾çš„ãªå¼·ã•ã‚’äºˆæ¸¬
- **æœ€ã‚‚é‡ã¿ãŒå¤§ãã„**ï¼ˆ50%ï¼‰

#### **3. Regressionï¼ˆ20%ï¼‰: èµ°ç ´ã‚¿ã‚¤ãƒ **
- èµ°ç ´ã‚¿ã‚¤ãƒ ã‚’äºˆæ¸¬
- é€Ÿã„ã‚¿ã‚¤ãƒ ã®é¦¬ã‚’å„ªå…ˆ

---

## ğŸ“‹ **å‡ºåŠ›ã‚«ãƒ©ãƒ èª¬æ˜**

| ã‚«ãƒ©ãƒ å | èª¬æ˜ |
|----------|------|
| `race_id` | ãƒ¬ãƒ¼ã‚¹ID |
| `umaban` | é¦¬ç•ª |
| `ensemble_score` | **çµ±åˆã‚¹ã‚³ã‚¢ï¼ˆæœ€çµ‚äºˆæ¸¬ã®æ ¹æ‹ ï¼‰** |
| `final_rank` | **äºˆæ¸¬ç€é †** |
| `binary_probability` | Binaryåˆ†é¡ã®ç¢ºç‡ï¼ˆ0ã€œ1ï¼‰ |
| `binary_rank` | Binaryäºˆæ¸¬é †ä½ |
| `ranking_score` | Rankingäºˆæ¸¬ã‚¹ã‚³ã‚¢ |
| `ranking_rank` | Rankingäºˆæ¸¬é †ä½ |
| `predicted_time` | äºˆæ¸¬èµ°ç ´ã‚¿ã‚¤ãƒ ï¼ˆç§’ï¼‰ |
| `time_rank` | ã‚¿ã‚¤ãƒ äºˆæ¸¬é †ä½ |

---

## âœ… **Phase 5 å‹•ä½œç¢ºèªå®Œäº†**

### **ç¢ºèªã§ããŸã“ã¨**
1. âœ… Phase 7 ã§é¸æŠã•ã‚ŒãŸç‰¹å¾´é‡ï¼ˆBinary: 31å€‹ã€Ranking: 25å€‹ã€Regression: 24å€‹ï¼‰ãŒæ­£ã—ãèª­ã¿è¾¼ã¾ã‚Œã‚‹
2. âœ… Phase 8 ã§æœ€é©åŒ–ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ï¼ˆBinary, Ranking, Regressionï¼‰ãŒæ­£å¸¸ã«å‹•ä½œ
3. âœ… 3ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬çµæœãŒæ­£ã—ãçµ±åˆã•ã‚Œã‚‹
4. âœ… ãƒ¬ãƒ¼ã‚¹ã”ã¨ã«ã‚¹ã‚³ã‚¢ãŒæ­£è¦åŒ–ã•ã‚Œã€å…¬å¹³ã«çµ±åˆã•ã‚Œã‚‹
5. âœ… äºˆæ¸¬çµæœCSVã¨ã‚µãƒãƒªãƒ¼JSONãŒæ­£ã—ãå‡ºåŠ›ã•ã‚Œã‚‹

---

## ğŸš€ **æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**

### **1. æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã§ã®äºˆæ¸¬ï¼ˆæ˜æ—¥ã®ãƒ¬ãƒ¼ã‚¹ï¼‰**
```bash
# æ˜æ—¥ï¼ˆ2026-02-12ï¼‰ã®èˆ¹æ©‹ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
# â†“
python scripts\phase5_ensemble\ensemble_optimized.py ^
  funabashi ^
  test_data\funabashi_20260212.csv ^
  --output-dir data\predictions\phase5_optimized
```

### **2. Phase 7 Ranking/Regressionï¼ˆæ®‹ã‚Š13ä¼šå ´ï¼‰å®Ÿè¡Œ**
```bash
cd E:\anonymous-keiba-ai

# Phase 7 Ranking
.\run_phase7_ranking_all.ps1

# Phase 7 Regression
.\run_phase7_regression_all.ps1
```

### **3. Phase 8 Ranking/Regressionï¼ˆæ®‹ã‚Š13ä¼šå ´ï¼‰å®Ÿè¡Œ**
```bash
# Phase 8 Ranking
.\run_phase8_ranking_all.ps1

# Phase 8 Regression
.\run_phase8_regression_all.ps1
```

---

## ğŸ¯ **èˆ¹æ©‹ã®ç¾åœ¨ã®çŠ¶æ…‹**

| Phase | Binary | Ranking | Regression |
|-------|--------|---------|------------|
| Phase 0 | âœ… å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ | âœ… å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ | âœ… å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ |
| Phase 7 | âœ… 31ç‰¹å¾´é‡ | âœ… 25ç‰¹å¾´é‡ | âœ… 24ç‰¹å¾´é‡ |
| Phase 8 | âœ… æœ€é©åŒ–å®Œäº† | âœ… æœ€é©åŒ–å®Œäº† | âœ… æœ€é©åŒ–å®Œäº† |
| **Phase 5** | **âœ… ãƒ†ã‚¹ãƒˆæˆåŠŸ** | **âœ… ãƒ†ã‚¹ãƒˆæˆåŠŸ** | **âœ… ãƒ†ã‚¹ãƒˆæˆåŠŸ** |

**èˆ¹æ©‹ã¯å®Œå…¨ã«ç¨¼åƒå¯èƒ½ï¼**

---

## ğŸ“Š **äºˆæ¸¬ç²¾åº¦ã®è©•ä¾¡ï¼ˆä»Šå¾Œã®èª²é¡Œï¼‰**

ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«ã¯å®Ÿéš›ã®ç€é †ãƒ‡ãƒ¼ã‚¿ï¼ˆ`kakutei_chakujun`ï¼‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã€äºˆæ¸¬ç²¾åº¦ã‚’è©•ä¾¡å¯èƒ½:

```python
# ç²¾åº¦è©•ä¾¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆä¾‹ï¼‰
import pandas as pd

# äºˆæ¸¬çµæœã‚’èª­ã¿è¾¼ã¿
pred = pd.read_csv('data/predictions/phase5_optimized/funabashi_107_ensemble_optimized.csv')

# å®Ÿéš›ã®çµæœã‚’èª­ã¿è¾¼ã¿
actual = pd.read_csv('data/training/funabashi_2020-2026_with_time_PHASE78.csv', encoding='shift-jis')

# race_idã¨umabanã§çµåˆ
merged = pred.merge(actual[['race_id', 'umaban', 'kakutei_chakujun']], on=['race_id', 'umaban'])

# çš„ä¸­ç‡ã‚’è¨ˆç®—
top3_accuracy = (merged['final_rank'] <= 3) & (merged['kakutei_chakujun'] <= 3)
print(f"3ç€ä»¥å†…çš„ä¸­ç‡: {top3_accuracy.mean():.2%}")
```

---

## ğŸ‰ **çµè«–**

**èˆ¹æ©‹ã® Phase 5 Ensemble ã¯å®Œç’§ã«å‹•ä½œã—ã¦ã„ã¾ã™ï¼**

- âœ… 3ãƒ¢ãƒ‡ãƒ«ï¼ˆBinary, Ranking, Regressionï¼‰ã®çµ±åˆæˆåŠŸ
- âœ… Phase 7/8 ã®æœ€é©åŒ–çµæœãŒæ­£å¸¸ã«åæ˜ 
- âœ… ãƒ¬ãƒ¼ã‚¹ã”ã¨ã®ã‚¹ã‚³ã‚¢æ­£è¦åŒ–ãŒæ­£ã—ãæ©Ÿèƒ½
- âœ… äºˆæ¸¬çµæœã®å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒæ­£ã—ã„

**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: æ®‹ã‚Š13ä¼šå ´ã® Phase 7/8 ã‚’å®Ÿè¡Œã—ã¦ã€å…¨14ä¼šå ´ã§ Phase 5 ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼

---

**GitHub URL**: https://github.com/aka209859-max/anonymous-keiba-ai/tree/phase0_complete_fix_2026_02_07
