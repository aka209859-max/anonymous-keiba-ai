# Phase 0 æœ€çµ‚ä¿®æ­£ãƒ¬ãƒãƒ¼ãƒˆï¼ˆ2026-02-08ï¼‰

## ğŸ“‹ ä¿®æ­£æ¦‚è¦

**æ—¥ä»˜**: 2026å¹´2æœˆ8æ—¥  
**ä¿®æ­£å¯¾è±¡**: `scripts/phase0_data_acquisition/extract_race_data.py`  
**ä¿®æ­£ç†ç”±**: pgAdminã§ã®å®Ÿæ¸¬ã«ã‚ˆã‚Šã€PC-KEIBAãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å®Ÿéš›ã®ã‚«ãƒ©ãƒ åã‚’å®Œå…¨ç¢ºèª

---

## ğŸ” **å®Ÿæ¸¬ã«ã‚ˆã‚Šåˆ¤æ˜ã—ãŸæ­£ã—ã„ã‚«ãƒ©ãƒ å**

### **ãƒ¬ãƒ¼ã‚¹åé–¢é€£ã‚«ãƒ©ãƒ **

| èª¤ã£ãŸæ¨æ¸¬ | å®Ÿéš›ã®ã‚«ãƒ©ãƒ å | èª¬æ˜ | æ¤œè¨¼æ–¹æ³• |
|-----------|--------------|------|---------|
| âŒ `race_me` | - | å­˜åœ¨ã—ãªã„ | pgAdminå®Ÿæ¸¬ |
| âŒ `hondai` | - | å­˜åœ¨ã—ãªã„ | pgAdminå®Ÿæ¸¬ |
| âœ… - | `kyosomei_hondai` | ãƒ¬ãƒ¼ã‚¹åï¼ˆç«¶èµ°åæœ¬é¡Œï¼‰ | pgAdminå®Ÿæ¸¬ |
| âœ… - | `kyosomei_ryakusho_10` | ãƒ¬ãƒ¼ã‚¹åç•¥ç§°ï¼ˆ10æ–‡å­—ï¼‰ | pgAdminå®Ÿæ¸¬ |
| âœ… - | `kyosomei_ryakusho_6` | ãƒ¬ãƒ¼ã‚¹åç•¥ç§°ï¼ˆ6æ–‡å­—ï¼‰ | pgAdminå®Ÿæ¸¬ |
| âœ… - | `kyosomei_ryakusho_3` | ãƒ¬ãƒ¼ã‚¹åç•¥ç§°ï¼ˆ3æ–‡å­—ï¼‰ | pgAdminå®Ÿæ¸¬ |

### **ãã®ä»–ã®é‡è¦ã‚«ãƒ©ãƒ ï¼ˆå­˜åœ¨ç¢ºèªæ¸ˆã¿ï¼‰**

| ã‚«ãƒ©ãƒ å | èª¬æ˜ | ãƒ‡ãƒ¼ã‚¿å‹ |
|---------|------|---------|
| âœ… `course_kubun` | ã‚³ãƒ¼ã‚¹åŒºåˆ† | character varying(2) |
| âœ… `tenko_code` | å¤©å€™ã‚³ãƒ¼ãƒ‰ | character varying(1) |
| âœ… `grade_code` | ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ | character varying(1) |
| âœ… `shusso_tosu` | å‡ºèµ°é ­æ•° | character varying(2) |
| âœ… `track_code` | ãƒˆãƒ©ãƒƒã‚¯ã‚³ãƒ¼ãƒ‰ | character varying(2) |

---

## ğŸ“Š **pgAdminã§ã®å®Ÿæ¸¬SQLå®Ÿè¡Œçµæœ**

### **SQL 1: nvd_ra ãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨ã‚«ãƒ©ãƒ ä¸€è¦§**

å®Ÿè¡Œçµæœ: **63ã‚«ãƒ©ãƒ **ï¼ˆå…¨ã¦ã®ã‚«ãƒ©ãƒ ã‚’ç¢ºèªï¼‰

ä¸»è¦ã‚«ãƒ©ãƒ :
```
kyosomei_hondai (ç«¶èµ°åæœ¬é¡Œ)
kyosomei_fukudai (ç«¶èµ°åå‰¯é¡Œ)
kyosomei_kakkonai (ç«¶èµ°åæ‹¬å¼§å†…)
kyosomei_ryakusho_10 (ç«¶èµ°åç•¥ç§°10æ–‡å­—)
kyosomei_ryakusho_6 (ç«¶èµ°åç•¥ç§°6æ–‡å­—)
kyosomei_ryakusho_3 (ç«¶èµ°åç•¥ç§°3æ–‡å­—)
course_kubun (ã‚³ãƒ¼ã‚¹åŒºåˆ†)
tenko_code (å¤©å€™ã‚³ãƒ¼ãƒ‰)
grade_code (ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰)
```

### **SQL 2: ä½è³€ç«¶é¦¬å ´ 2026-02-07 ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿**

å–å¾—ãƒ¬ãƒ¼ã‚¹æ•°: **12ãƒ¬ãƒ¼ã‚¹**

ã‚µãƒ³ãƒ—ãƒ«:
```
race_bango | kyosomei_hondai                           | kyori | track_code | tenko_code | grade_code
-----------|------------------------------------------|-------|------------|------------|------------
01         | ãƒ‘ãƒƒã‚«ãƒ«ãã‚“ã®ãŠã¨ã—ã‚‚ã®è³                | 1400  | 24         | 0          |  
02         | (ç©ºç™½)                                   | 1400  | 24         | 0          |  
03         | (ç©ºç™½)                                   | 1400  | 24         | 0          |  
04         | ä¸ƒãƒ„é‡œç‰¹åˆ¥                               | 1750  | 24         | 0          | E
05         | å¦‚æœˆè³                                   | 1750  | 24         | 0          | T
```

---

## âœ… **å®Ÿæ–½ã—ãŸä¿®æ­£**

### **ä¿®æ­£å‰ï¼ˆã‚¨ãƒ©ãƒ¼ï¼‰**
```python
query = """
SELECT 
    race_me,        # âŒ å­˜åœ¨ã—ãªã„
    hondai,         # âŒ å­˜åœ¨ã—ãªã„
    ...
FROM nvd_ra
"""
```

### **ä¿®æ­£å¾Œï¼ˆæ­£å¸¸ï¼‰**
```python
query = """
SELECT 
    kyosomei_hondai,         -- âœ… ãƒ¬ãƒ¼ã‚¹åï¼ˆç«¶èµ°åæœ¬é¡Œï¼‰
    kyosomei_ryakusho_10,    -- âœ… ãƒ¬ãƒ¼ã‚¹åç•¥ç§°ï¼ˆ10æ–‡å­—ï¼‰
    course_kubun,            -- âœ… ã‚³ãƒ¼ã‚¹åŒºåˆ†ï¼ˆå­˜åœ¨ç¢ºèªæ¸ˆã¿ï¼‰
    ...
FROM nvd_ra
WHERE track_code != '00'  -- ã°ã‚“ãˆã„ç«¶é¦¬ã‚’é™¤å¤–
"""
```

---

## ğŸ“Š **ä¿®æ­£å¾Œã®æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**

### **Phase 0 å‡ºåŠ›**

**ãƒ•ã‚¡ã‚¤ãƒ«å**: `data/raw/YYYY/MM/{keibajo}_{YYYYMMDD}_raw.csv`

**æœŸå¾…ã‚«ãƒ©ãƒ æ•°**: **ç´„60ã‚«ãƒ©ãƒ **
- åŸºæœ¬æƒ…å ±: 6ã‚«ãƒ©ãƒ 
- ãƒ¬ãƒ¼ã‚¹æƒ…å ±: 10ã‚«ãƒ©ãƒ ï¼ˆkyosomei_hondai, tenko_code, shusso_tosu, grade_code å«ã‚€ï¼‰
- å‡ºé¦¬æƒ…å ±: 8ã‚«ãƒ©ãƒ ï¼ˆchokyoshi_code, blinker_shiyo_kubun å«ã‚€ï¼‰
- é¦¬æƒ…å ±: 2ã‚«ãƒ©ãƒ ï¼ˆbamei, moshoku_codeï¼‰
- éå»èµ°ãƒ‡ãƒ¼ã‚¿: 33ã‚«ãƒ©ãƒ ï¼ˆprev1ã€œprev5ï¼‰

### **Phase 1 å‡ºåŠ›**

**ãƒ•ã‚¡ã‚¤ãƒ«å**: `data/features/YYYY/MM/{keibajo}_{YYYYMMDD}_features.csv`

**æœŸå¾…ã‚«ãƒ©ãƒ æ•°**: **50ã‚«ãƒ©ãƒ **ï¼ˆrace_id + 49ç‰¹å¾´é‡ï¼‰

**ä¸è¶³ç‰¹å¾´é‡**: **0å€‹**ï¼ˆä¿®æ­£å‰ã¯34å€‹ä¸è¶³ï¼‰

---

## ğŸ”— **å®Ÿæ¸¬æ¤œè¨¼SQLï¼ˆå†ç¾æ‰‹é †ï¼‰**

### **Step 1: ã‚«ãƒ©ãƒ ä¸€è¦§ã®ç¢ºèª**
```sql
SELECT column_name, data_type, character_maximum_length
FROM information_schema.columns
WHERE table_name = 'nvd_ra'
ORDER BY ordinal_position;
```

### **Step 2: ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª**
```sql
SELECT *
FROM nvd_ra
WHERE keibajo_code = '55'
  AND kaisai_nen = '2026'
  AND kaisai_tsukihi = '0207'
LIMIT 5;
```

### **Step 3: ãƒ¬ãƒ¼ã‚¹åé–¢é€£ã‚«ãƒ©ãƒ ã®æ¤œç´¢**
```sql
SELECT column_name
FROM information_schema.columns
WHERE table_name = 'nvd_ra'
  AND (
    column_name LIKE '%mei%' 
    OR column_name LIKE '%name%'
    OR column_name LIKE '%dai%'
    OR column_name LIKE '%race%'
    OR column_name LIKE '%kyoso%'
  );
```

---

## âœ… **æ¤œè¨¼æ–¹æ³•**

### **Step 1: Phase 0 å®Ÿè¡Œ**
```bash
cd E:\anonymous-keiba-ai
python scripts\phase0_data_acquisition\extract_race_data.py --keibajo 55 --date 20260207
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
[SUCCESS] ãƒ‡ãƒ¼ã‚¿ä¿å­˜å®Œäº†
  å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«: data/raw/2026/02/ä½è³€_20260207_raw.csv
  ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: 126ä»¶
  ã‚«ãƒ©ãƒ æ•°: 60å€‹
âœ… [SUCCESS] å¿…è¦ãªç‰¹å¾´é‡ï¼ˆéå»èµ°ãƒ‡ãƒ¼ã‚¿ãƒ»é¦¬åç­‰ï¼‰ã¯ã™ã¹ã¦æ­£å¸¸ã«å«ã¾ã‚Œã¦ã„ã¾ã™
```

### **Step 2: ã‚«ãƒ©ãƒ æ•°ã®ç¢ºèª**
```bash
python -c "import pandas as pd; df=pd.read_csv('data/raw/2026/02/ä½è³€_20260207_raw.csv', encoding='utf-8'); print('ã‚«ãƒ©ãƒ æ•°:', len(df.columns)); print('prev1_rank' in df.columns, 'chokyoshi_code' in df.columns, 'bamei' in df.columns)"
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
ã‚«ãƒ©ãƒ æ•°: 60
True True True
```

### **Step 3: Phase 1 å®Ÿè¡Œ**
```bash
python prepare_features.py data\raw\2026\02\ä½è³€_20260207_raw.csv
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
[4/6] ç‰¹å¾´é‡ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ä¸­...
âœ… ä½¿ç”¨å¯èƒ½ãªç‰¹å¾´é‡: 50 / 50
âœ… ç‰¹å¾´é‡ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å®Œäº†
  - æœ€çµ‚ç‰¹å¾´é‡æ•°: 50å€‹
```

---

## ğŸ“Œ **é‡è¦ãªæ•™è¨“**

### **1. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ä¾å­˜ã—ãªã„**
- ã€ŒPC-KEIBAãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®å®Œå…¨è§£æã€è³‡æ–™ã§ã‚‚ã€å®Ÿéš›ã®ã‚«ãƒ©ãƒ åï¼ˆ`kyosomei_hondai`ï¼‰ã¯è¨˜è¼‰ã•ã‚Œã¦ã„ãªã‹ã£ãŸ
- **å®Ÿæ¸¬ãŒæœ€ã‚‚ç¢ºå®Ÿ**ï¼špgAdminã§ã®ç›´æ¥ç¢ºèªãŒå¿…é ˆ

### **2. ã‚«ãƒ©ãƒ åã®å‘½åè¦å‰‡**
- PC-KEIBAã¯ **æ—¥æœ¬èªã®ãƒ­ãƒ¼ãƒå­—è¡¨è¨˜** ã‚’æ¡ç”¨
- `race_me` â†’ âŒï¼ˆè‹±èªçš„ãªè«–ç†åï¼‰
- `kyosomei_hondai` â†’ âœ…ï¼ˆæ—¥æœ¬èªã®ãƒ­ãƒ¼ãƒå­—ï¼‰

### **3. æ¨æ¸¬ã‚ˆã‚Šã‚‚æ¤œè¨¼**
- `hondai` ã‚‚æ¨æ¸¬ã§ã‚ã‚Šã€å®Ÿéš›ã¯ `kyosomei_hondai`
- **æ¨æ¸¬ã«é ¼ã‚‰ãšã€å¿…ãšå®Ÿæ¸¬ã§æ¤œè¨¼**

---

## ğŸ”— **é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**

### **ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«**
- `scripts/phase0_data_acquisition/extract_race_data.py` - å®Œå…¨ç‰ˆï¼ˆå®Ÿæ¸¬ä¿®æ­£æ¸ˆã¿ï¼‰

### **æ¤œè¨¼è³‡æ–™**
- pgAdminå®Ÿè¡Œçµæœ: nvd_ra ãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨ã‚«ãƒ©ãƒ ä¸€è¦§ï¼ˆ63ã‚«ãƒ©ãƒ ï¼‰
- pgAdminå®Ÿè¡Œçµæœ: ä½è³€ç«¶é¦¬å ´ 2026-02-07 ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆ12ãƒ¬ãƒ¼ã‚¹ï¼‰

---

## ğŸ“ **Pull Request**

**PR #4**: https://github.com/aka209859-max/anonymous-keiba-ai/pull/4

æœ€æ–°ã‚³ãƒŸãƒƒãƒˆ: `7590725` - å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã«åŸºã¥ãæœ€çµ‚ä¿®æ­£

---

**ä¿®æ­£æ—¥**: 2026å¹´2æœˆ8æ—¥  
**ä¿®æ­£è€…**: Claude (AI Developer) + ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆpgAdminå®Ÿæ¸¬ï¼‰  
**æ¤œè¨¼**: pgAdminã§ã®å®Ÿæ¸¬ã«ã‚ˆã‚Šå®Œå…¨ç¢ºèª  
**æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼äºˆå®š**: Phase 0å®Ÿè¡Œå¾Œ
